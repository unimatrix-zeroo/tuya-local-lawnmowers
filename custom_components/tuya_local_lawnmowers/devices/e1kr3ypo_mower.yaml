name: Generic Tuya mower (modelId e1kr3ypo)
product_ids:
  - e1kr3ypo

entities:
  - entity: lawn_mower
    icon: mdi:robot-mower
    dps:
      - id: 101
        type: enum
        name: activity
        mapping:
          - dps_val: STANDBY
            value: docked
          - dps_val: CHARGING
            value: docked
          - dps_val: CHARGING_WITH_TASK_SUSPEND
            value: docked
          - dps_val: PARK
            value: docked
          - dps_val: MOWING
            value: mowing
          - dps_val: FIXED_MOWING
            value: mowing
          - dps_val: PAUSED
            value: paused
          - dps_val: ERROR
            value: error
          - dps_val: EMERGENCY
            value: error
          - dps_val: LOCKED
            value: error

      - id: 115
        type: enum
        name: command

    commands:
      start:   { dps: 115, value: StartMowing }
      pause:   { dps: 115, value: PauseWork }
      resume:  { dps: 115, value: ContinueWork }
      dock:    { dps: 115, value: StartReturnStation }
      stop:    { dps: 115, value: CancelWork }

    services:
      start_fixed_mowing: { dps: 115, value: StartFixedMowing }

  - entity: sensor
    name: Battery
    device_class: battery
    unit_of_measurement: "%"
    dps:
      - id: 6
        type: integer
        name: battery

  - entity: binary_sensor
    name: Problem
    device_class: problem
    dps:
      - id: 102
        type: bitfield     
        name: fault
        optional: true

  - entity: sensor
    name: Warning
    icon: mdi:alert-circle
    dps:
      - id: 103
        type: enum
        name: warning
        optional: true

  - entity: binary_sensor
    name: Cover
    device_class: opening
    dps:
      - id: 116
        type: boolean
        name: open
        mapping:
          - dps_val: true
            value: on
          - dps_val: false
            value: off

  - entity: switch
    name: Rain mode
    icon: mdi:weather-rainy
    dps:
      - id: 104
        type: boolean
        name: switch

  - entity: number
    name: Work time
    icon: mdi:timer-cog
    dps:
      - id: 105
        type: integer
        name: value
        unit: h
        range: { min: 1, max: 99 }
        step: 1

  - entity: number
    name: PIN code
    entity_category: config
    icon: mdi:form-textbox-password
    dps:
      - id: 106
        type: integer
        name: value
        range: { min: 1111, max: 4444 }

  - entity: button
    name: Clear schedule
    entity_category: config
    icon: mdi:calendar-remove
    dps:
      - id: 107
        type: boolean
        name: button
        payload_on: true

  - entity: button
    name: Query schedule
    entity_category: diagnostic
    icon: mdi:calendar-search
    dps:
      - id: 108
        type: boolean
        name: button
        payload_on: true

  - entity: button
    name: Query partitions
    entity_category: diagnostic
    icon: mdi:map-search
    dps:
      - id: 109
        type: boolean
        name: button
        payload_on: true

  - entity: sensor
    name: Error log
    entity_category: diagnostic
    icon: mdi:file-alert
    dps:
      - id: 111
        type: string     # <— vorher: raw
        name: value
        optional: true

  - entity: sensor
    name: Work log
    entity_category: diagnostic
    icon: mdi:book-clock
    dps:
      - id: 112
        type: string     # <— vorher: raw
        name: value
        optional: true

  - entity: sensor
    name: Partitions
    entity_category: diagnostic
    icon: mdi:grid
    dps:
      - id: 113
        type: string     # <— vorher: raw
        name: value
        optional: true

  - entity: switch
    name: Hedgehog protection
    icon: mdi:shield-sun
    dps:
      - id: 118
        type: boolean
        name: switch
        optional: true

  - entity: sensor
    name: Firmware
    icon: mdi:chip
    dps:
      - id: 134
        type: string
        name: value
        optional: true

  - entity: sensor
    name: Rain delay (raw)
    entity_category: diagnostic
    icon: mdi:weather-pouring
    dps:
      - id: 139
        type: string     # <— vorher: raw
        name: value
        optional: true
